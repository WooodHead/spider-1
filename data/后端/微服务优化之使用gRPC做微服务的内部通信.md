

## 使用gRPC做微服务的内部通信

gRPC是一个由Google开源的远程服务调用框架，具有多路复用和双向流式通信的特性。<img referrerpolicy="no-referrer" data-src="/img/remote/1460000021954107" src="https://cdn.segmentfault.com/v-5e67172c/global/img/squares.svg" alt title>大家好，在本文中将为大家介绍为什么我们应该使用gRPC代替RESTful或JSON，来开发微服务内部的通信接口。

## 什么是gRPC?

gRPC是一个高性能的、开源的、普遍通用的RPC框架。简单地说，它能够帮助我们建立透明的服务端和客户端通信系统。Google开发了GRPC并且将其开源。 通过它，一个客户端消费者服务可以像调用本地方法一样，调用另一台主机上面的服务端方法。 gRPC本质上仍然遵循常规的Remote Procedure Call (RPC) 技术，但是在实现上使用了HTTP2.0、协议缓冲区等更现代化的技术方案，从而最大程度上确保服务端和客户端的互操作性及性能上的提升。

### 服务之间如何使用gRPC通信？

当客户端向服务端发起请求的时候，客户端gRPC类库使用协议缓冲区并且封装远程过程调用(RPC),并且将其通过HTTP2发送到服务端。服务端将其拆封，并且使用协议缓冲区调用对应的程序。响应数据的过程和发送请求的过程是类似的，只不过一个是从客户端到服务端，一个是从服务端到客户端。从开发的角度，在服务端和客户端使用gRPC最大的好处在于：你的服务端的代码和客户端的代码不需要担心它会影响你解析JSON或者其他类似的文本格式消息。gRPC虽然接收到的是二进制格式，但会并将其反序列化为对象。同样的我们可以通过IDL来定义服务接口，IDL是非常强大的一个特性，帮助我们处理多个微服务之间的互操作。

### 为什么gRPC是高效的？

*  它基于HTTP2构建，既支持传统的请求-响应模型，也支持双向流模型。
*  可以将JSON数据转换到协议缓冲区
*  多路复用
*  双向流模型
*  网络传输的是二进制数据，相对于JSON等文本数据更加轻量级。
*  多语言支持

## 什么时候使用gRPC？

最初，几乎所有的微服务之间都是通过JSON数据接口通信的，一个服务可能调用空一个服务或者多个服务，被调用的服务可能还调用其他服务。如果其中任何一个服务运行缓慢，将影响整个系统的运行速度，因为RESTful(JSON) API不支持HTTP2的多路复用和双向流模型。传统的RESTful接口使用JSON、XML或者其他的一些格式作为数据载体，使得服务运行缓慢，内存占用较高、并且传输过程没有压缩。![]()gRPC解决所有的这些问题，但是它仅仅用于系统应用微服务之间的通信的情况，系统的对外服务接口仍然使用HTTP-JSON接口。这样保证对外部用户的开发技术栈没有任何影响。

## 总结 Conclusion

与传统REST API相比，使用gRPC创建的API可以为你的应用带来令人难以置信的性能改进。

## 欢迎关注我的博客，里面有很多精品合集

*  本文转载注明出处（必须带连接，不能只转文字）：[字母哥博客](http://www.zimug.com)。
